<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet' href='fonts/Raleway.css'>
    <link rel='stylesheet' href='fonts/font-awesome.min.css'>
    <link rel="stylesheet" href="index.css">
    <script>
        // Name conflicts with jquerry
        window.nodeRequire = require;
        delete window.require;
        delete window.exports;
        delete window.module;
    </script>
    <script>
        // Get the track locations from main.js by using ipcRenderer to send a requst to main
        const ipc = window.nodeRequire('electron').ipcRenderer;
        const tracks = ipc.sendSync("tracks");
        console.log(tracks);
    </script>
    <script src='jquery/3.4.1/jquery.min.js'></script>
    <script src="index.js"></script>
</head>

<body>
    <main class="main">

        <div class="image-area">
            <i class="fa fa-pause fa-3x nav-item" id="play-pause"></i>
        </div>

        <div class="player-body">
            <div class="title-area">
                <h3 class="title">My title</h3>
            </div>
            <div class="controls">
                <div class="titlebar">
                    <i class="fa fa-window-minimize fa-lg nav-item" id="minimize"></i>
                    <i class="fa fa-cog fa-lg nav-item" id="settings"></i>
                    <i class="fa fa-times fa-lg nav-item" id="close"></i>
                </div>
                <div class="navbar">
                    <div class="navbar-items">
                        <i id="step-backward" class="fa fa-step-backward fa-lg nav-item"></i>
                        <i id="step-forward" class="fa fa-step-forward fa-lg nav-item"></i>
                        <i id="random" class="fa fa-random fa-lg nav-item"></i>
                        <i id="repeat" class="fa fa-repeat fa-lg nav-item"></i>
                    </div>
                    <div class="navbar-items">
                        <i id="volume" class="fa fa-volume-up fa-lg nav-item"></i>
                        <input id="volume-slider" min="0" max="100" value="100" type="range">
                    </div>
                </div>
            </div>
        </div>

    </main>
</body>
<script>
    // Send to main that you want to quit
    // ipc is ipcRenderer which is declared above
    $('#close').click(function () {
        ipc.send('exit', true);
    });

    $('#settings').click(function () {
        ipc.send('settings', true);
    });

    $('#minimize').click(function () {
        ipc.send('minimize', true);
    });

    // Send volume slider position to main so it can be saved
    $("#volume-slider").bind('change', () => {
        audioPlayer.volume = $("#volume-slider").val() / 100;

        ipc.send('volumeChange', audioPlayer.volume);
    });

    // On launch get saved volume and set the slider and player to use it
    const savedVolume = ipc.sendSync('getVolume');
    $("#volume-slider").val(savedVolume * 100);
    console.log(`Received saved volume value: ${savedVolume}`);
    audioPlayer.volume = savedVolume;
</script>

</html>